"use strict";(self.webpackChunkau=self.webpackChunkau||[]).push([[824],{3824:(jt,J,h)=>{h.r(J),h.d(J,{FormsInDepthModule:()=>Pt});var I=h(1601),g=h(3065),B=h(8583),H=h(5566),W=h(439),e=h(7716);let X=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[],imports:[[B.ez,H.o9,W.p]]}),t})();var k=h(4598),b=h(6983);let V=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-fid"]],decls:2,vars:0,consts:[[1,"container-fluid","mt-3"]],template:function(n,a){1&n&&(e.TgZ(0,"section",0),e._UZ(1,"router-outlet"),e.qZA())},directives:[b.lC],styles:[""]}),t})();const K=(0,g.PH)("[Upload/UI] attach a file",(0,g.Ky)()),P=(0,g.PH)("[Upload/API] Upload file start",(0,g.Ky)()),$=(0,g.PH)("[Upload/API] Upload file successful",(0,g.Ky)()),N=((0,g.PH)("[Upload/API] Upload file failed",(0,g.Ky)()),(0,g.PH)("[Upload/API] Upload file progress update",(0,g.Ky)())),G="uploadFiles";var l=(()=>{return(t=l||(l={}))[t.EntitiesOnly=0]="EntitiesOnly",t[t.Both=1]="Both",t[t.None=2]="None",l;var t})();function m(t){return function(n,a){const f={ids:[...a.ids],entities:Object.assign({},a.entities)},F=t(n,f);return F===l.Both?Object.assign({},a,f):F===l.EntitiesOnly?Object.assign(Object.assign({},a),{entities:f.entities}):a}}function M(t,s){const n=s(t);return(0,e.X6Q)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",t,"The `selectId` implementation:",s.toString()),n}function Y(t){function s(d,r){const o=M(d,t);return o in r.entities?l.None:(r.ids.push(o),r.entities[o]=d,l.Both)}function n(d,r){let o=!1;for(const i of d)o=s(i,r)!==l.None||o;return o?l.Both:l.None}function f(d,r){const o=M(d,t);return o in r.entities?(r.entities[o]=d,l.EntitiesOnly):(r.ids.push(o),r.entities[o]=d,l.Both)}function A(d,r){const i=(d instanceof Array?d:r.ids.filter(c=>d(r.entities[c]))).filter(c=>c in r.entities).map(c=>delete r.entities[c]).length>0;return i&&(r.ids=r.ids.filter(c=>c in r.entities)),i?l.Both:l.None}function S(d,r){return Z([d],r)}function Z(d,r){const o={};return(d=d.filter(c=>c.id in r.entities)).length>0?d.filter(u=>function(d,r,o){const c=Object.assign({},o.entities[r.id],r.changes),u=M(c,t),p=u!==r.id;return p&&(d[r.id]=u,delete o.entities[r.id]),o.entities[u]=c,p}(o,u,r)).length>0?(r.ids=r.ids.map(u=>o[u]||u),l.Both):l.EntitiesOnly:l.None}function L(d,r){const o=[],i=[];for(const p of d){const v=M(p,t);v in r.entities?i.push({id:v,changes:p}):o.push(p)}const c=Z(i,r),u=n(o,r);switch(!0){case u===l.None&&c===l.None:return l.None;case u===l.Both||c===l.Both:return l.Both;default:return l.EntitiesOnly}}return{removeAll:function(d){return Object.assign({},d,{ids:[],entities:{}})},addOne:m(s),addMany:m(n),setAll:m(function(d,r){return r.ids=[],r.entities={},n(d,r),l.Both}),setOne:m(f),setMany:m(function(d,r){const o=d.map(i=>f(i,r));switch(!0){case o.some(i=>i===l.Both):return l.Both;case o.some(i=>i===l.EntitiesOnly):return l.EntitiesOnly;default:return l.None}}),updateOne:m(S),updateMany:m(Z),upsertOne:m(function(d,r){return L([d],r)}),upsertMany:m(L),removeOne:m(function(d,r){return A([d],r)}),removeMany:m(A),map:m(function(d,r){return Z(r.ids.reduce((c,u)=>{const p=d(r.entities[u]);return p!==r.entities[u]&&c.push({id:u,changes:p}),c},[]).filter(({id:c})=>c in r.entities),r)}),mapOne:m(function({map:d,id:r},o){const i=o.entities[r];return i?S({id:r,changes:d(i)},o):l.None})}}const U=function(t={}){const{selectId:s,sortComparer:n}=Object.assign({sortComparer:!1,selectId:y=>y.id},t),a={getInitialState:function(s={}){return Object.assign({ids:[],entities:{}},s)}},f={getSelectors:function(s){const n=y=>y.ids,a=y=>y.entities,f=(0,g.P1)(n,a,(y,A)=>y.map(T=>A[T])),F=(0,g.P1)(n,y=>y.length);return s?{selectIds:(0,g.P1)(s,n),selectEntities:(0,g.P1)(s,a),selectAll:(0,g.P1)(s,f),selectTotal:(0,g.P1)(s,F)}:{selectIds:n,selectEntities:a,selectAll:f,selectTotal:F}}},F=n?function(t,s){const{removeOne:n,removeMany:a,removeAll:f}=Y(t);function F(o,i){return y([o],i)}function y(o,i){const c=o.filter(u=>!(M(u,t)in i.entities));return 0===c.length?l.None:(r(c,i),l.Both)}function T(o,i){const c=M(o,t);return c in i.entities?(i.ids=i.ids.filter(u=>u!==c),r([o],i),l.Both):F(o,i)}function S(o,i){return x([o],i)}function x(o,i){const c=[],u=o.filter(p=>function(o,i,c){if(!(i.id in c.entities))return!1;const p=Object.assign({},c.entities[i.id],i.changes),v=M(p,t);return delete c.entities[i.id],o.push(p),v!==i.id}(c,p,i)).length>0;if(0===c.length)return l.None;{const p=i.ids,v=[];return i.ids=i.ids.filter((O,E)=>O in i.entities||(v.push(E),!1)),r(c,i),!u&&v.every(O=>i.ids[O]===p[O])?l.EntitiesOnly:l.Both}}function d(o,i){const c=[],u=[];for(const O of o){const E=M(O,t);E in i.entities?u.push({id:E,changes:O}):c.push(O)}const p=x(u,i),v=y(c,i);switch(!0){case v===l.None&&p===l.None:return l.None;case v===l.Both||p===l.Both:return l.Both;default:return l.EntitiesOnly}}function r(o,i){o.sort(s);const c=[];let u=0,p=0;for(;u<o.length&&p<i.ids.length;){const v=o[u],O=M(v,t),E=i.ids[p];s(v,i.entities[E])<=0?(c.push(O),u++):(c.push(E),p++)}i.ids=c.concat(u<o.length?o.slice(u).map(t):i.ids.slice(p)),o.forEach((v,O)=>{i.entities[t(v)]=v})}return{removeOne:n,removeMany:a,removeAll:f,addOne:m(F),updateOne:m(S),upsertOne:m(function(o,i){return d([o],i)}),setAll:m(function(o,i){return i.entities={},i.ids=[],y(o,i),l.Both}),setOne:m(T),setMany:m(function(o,i){const c=o.map(u=>T(u,i));switch(!0){case c.some(u=>u===l.Both):return l.Both;case c.some(u=>u===l.EntitiesOnly):return l.EntitiesOnly;default:return l.None}}),addMany:m(y),updateMany:m(x),upsertMany:m(d),map:m(function(o,i){return x(i.ids.reduce((u,p)=>{const v=o(i.entities[p]);return v!==i.entities[p]&&u.push({id:p,changes:v}),u},[]),i)}),mapOne:m(function({map:o,id:i},c){const u=c.entities[i];return u?S({id:i,changes:o(u)},c):l.None})}}(s,n):Y(s);return Object.assign(Object.assign(Object.assign({selectId:s,sortComparer:n},a),f),F)}({selectId:function(t){return t.id},sortComparer:function(t,s){return t.attachDate&&s.attachDate?t.attachDate<s.attachDate?1:-1:1}}),ut=U.getInitialState({uploading:!1}),dt=(0,g.Lq)(ut,(0,g.on)(P,(t,{file:s,fileId:n})=>{const a={attachDate:(new Date).getTime(),dateModified:s.lastModified,file:s,fileName:s.name,fileSize:s.size,id:n,completed:!1,progress:0};return U.addOne(a,Object.assign(Object.assign({},t),{loading:!0}))}),(0,g.on)(N,(t,{fileId:s,progress:n})=>U.updateOne({id:s,changes:{progress:n}},Object.assign(Object.assign({},t),{loading:!0}))),(0,g.on)($,(t,{fileId:s})=>U.updateOne({id:s,changes:{completed:!0}},Object.assign(Object.assign({},t),{loading:!0}))));function pt(t,s){return dt(t,s)}const C=(0,g.ZF)(G),ft=((0,g.P1)(C,U.getSelectors().selectIds),(0,g.P1)(C,U.getSelectors().selectEntities),(0,g.P1)(C,U.getSelectors().selectAll));(0,g.P1)(C,U.getSelectors().selectTotal),(0,g.P1)(C,t=>t.uploading);let gt=(()=>{class t{constructor(n){this.store=n,this.filesUploadingAll$=this.store.select(ft)}attachFile(n,a){this.store.dispatch(K({file:n,fileId:a}))}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(g.yh))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var mt=h(1841),j=h(5618),z=h(8295),ht=h(9983),yt=h(1095),vt=h(6627),Ft=h(4885);let Ot=(()=>{class t{constructor(){this.progress=0,this.mode="indeterminate",this.diameter=25}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["shared-progress-spinner"]],inputs:{progress:"progress",mode:"mode",diameter:"diameter"},decls:2,vars:3,consts:[[3,"mode","value","diameter"]],template:function(n,a){1&n&&(e.TgZ(0,"div"),e._UZ(1,"mat-spinner",0),e.qZA()),2&n&&(e.xp6(1),e.Q6J("mode",a.mode)("value",a.progress)("diameter",a.diameter))},directives:[Ft.$g],styles:[""]}),t})();const Mt=["uploadInput"];function At(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"div"),e._uU(2),e.qZA(),e.BQk()),2&t){const n=e.oxw().ngIf;e.xp6(2),e.hij(" ",n.length," files uploading... ")}}function It(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"shared-progress-spinner",12),e.BQk()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Q6J("progress",n.progress)("mode","determinate")("diameter",30)}}function Ut(t,s){1&t&&(e.TgZ(0,"div",13),e.TgZ(1,"mat-icon"),e._uU(2,"cloud_done"),e.qZA(),e.qZA())}function Et(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"div",9),e.TgZ(2,"div"),e.YNc(3,It,2,3,"ng-container",10),e.qZA(),e.YNc(4,Ut,3,0,"ng-template",null,11,e.W1O),e.TgZ(6,"div"),e._uU(7),e.qZA(),e.TgZ(8,"div"),e._uU(9),e.qZA(),e.TgZ(10,"div"),e._uU(11),e.qZA(),e.qZA(),e.BQk()),2&t){const n=s.$implicit,a=e.MAs(5);e.xp6(3),e.Q6J("ngIf",!n.completed)("ngIfElse",a),e.xp6(4),e.hij(" ",n.fileName," "),e.xp6(2),e.hij(" ",n.fileSize," "),e.xp6(2),e.hij(" ",n.progress,"% ")}}function Tt(t,s){if(1&t&&(e.ynx(0),e.YNc(1,At,3,1,"ng-container",7),e.YNc(2,Et,12,5,"ng-container",8),e.BQk()),2&t){const n=s.ngIf;e.xp6(1),e.Q6J("ngIf",n.length>0),e.xp6(1),e.Q6J("ngForOf",n)}}const Zt=[{path:"",component:V,children:[{path:"",redirectTo:"reactive",pathMatch:"full"},{path:"reactive",component:(()=>{class t{constructor(n,a){this.fs=n,this.http=a}ngOnInit(){}onUploadFileChange(n){var a;const f=null===(a=n.target)||void 0===a?void 0:a.files;f&&Object.keys(f).forEach(y=>{this.fs.attachFile(f[y],(new Date).getTime()+y+"")})}onUploadClick(){var n;const a=null===(n=this.uploadInput)||void 0===n?void 0:n.nativeElement;a&&a.click()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(gt),e.Y36(mt.eN))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-fid-reactive"]],viewQuery:function(n,a){if(1&n&&e.Gf(Mt,5),2&n){let f;e.iGM(f=e.CRH())&&(a.uploadInput=f.first)}},decls:16,vars:4,consts:[["fxLayout","column","fxLayoutAlign","start start","fxLayoutGap","20px",1,"parent","w-100"],["fxLayout","column","fxLayoutAlign","start start","fxLayoutGap","5px",1,"w-100"],["type","file","multiple","",1,"upload-input",3,"change"],["uploadInput",""],["appearance","standard",1,""],["matInput","","type","text",3,"disabled"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","15px"],[4,"ngIf","ngIfElse"],["done",""],[3,"progress","mode","diameter"],["fxLayout","row","fxLayoutAlign","center center"]],template:function(n,a){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._uU(2," Reactive Forms "),e.qZA(),e.TgZ(3,"div"),e._uU(4," Select files to upload "),e.qZA(),e.TgZ(5,"div"),e.TgZ(6,"input",2,3),e.NdJ("change",function(F){return a.onUploadFileChange(F)}),e.qZA(),e.TgZ(8,"mat-form-field",4),e._UZ(9,"input",5),e.TgZ(10,"button",6),e.NdJ("click",function(){return a.onUploadClick()}),e.TgZ(11,"mat-icon"),e._uU(12,"file_upload"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div"),e.YNc(14,Tt,3,2,"ng-container",7),e.ALo(15,"async"),e.qZA(),e.qZA()),2&n&&(e.xp6(9),e.Q6J("disabled",!0),e.xp6(5),e.Q6J("ngIf",e.lcZ(15,2,a.fs.filesUploadingAll$)))},directives:[j.xw,j.Wh,j.SQ,z.KE,ht.Nt,yt.lW,z.R9,vt.Hw,B.O5,B.sg,Ot],pipes:[B.Ov],styles:[".upload-input[_ngcontent-%COMP%]{display:none}"]}),t})(),data:{pageTitle:"Reactive Forms"}}]}];let xt=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[b.Bz.forChild(Zt)],b.Bz]}),t})();var R=h(8002),Ct=h(9773),St=h(5257),Bt=h(5435),Lt=h(6797);const bt=[(()=>{class t{constructor(n){this.actions$=n,this.attachFileForUpload$=(0,I.GW)(()=>this.actions$.pipe((0,I.l4)(K),(0,R.U)(a=>P({fileId:a.fileId,file:a.file}))),{dispatch:!0}),this.uploadFileStart$=(0,I.GW)(()=>this.actions$.pipe((0,I.l4)(P),(0,Ct.zg)(a=>{const f=a.fileId;return(0,Lt.H)(0,500).pipe((0,St.q)(10),(0,R.U)(y=>{const A=10*(y+1);return console.log(A,f),N({fileId:f,progress:A})}))}))),this.uploadFileFinished$=(0,I.GW)(()=>this.actions$.pipe((0,I.l4)(N),(0,Bt.h)(a=>100===a.progress),(0,R.U)(a=>$({fileId:a.fileId}))))}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(I.eX))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})()];let Pt=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[],imports:[[k.n,X,g.Aw.forFeature(G,pt),I.sQ.forFeature(bt),xt]]}),t})()}}]);